<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>进无止境&#39;s 博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta property="og:type" content="website">
<meta property="og:title" content="进无止境's 博客">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="进无止境's 博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="进无止境's 博客">
  
    <link rel="alternate" href="/atom.xml" title="进无止境&#39;s 博客" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/mylogo.jpg">
  <link rel="apple-touch-icon" href="/css/images/mylogo.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    <link rel="stylesheet" href="/css/home.css" >
  

  

  

</head>



  <body>


  
    <header id="header">

  
    <div id="intrologo" class="intro-logo">
  

    <canvas width="100%" height="100%"></canvas>
    <script>
      var c = document.getElementsByTagName('canvas')[0],
          x = c.getContext('2d'),
          w = window.innerWidth,
          h = window.innerHeight,
          pr = window.devicePixelRatio || 1,
          f = 90,
          q,
          m = Math,
          r = 0,
          u = m.PI*2,
          v = m.cos,
          z = m.random
      c.width = w*pr
      c.height = h*pr
      x.scale(pr, pr)
      x.globalAlpha = 0.6

      
        function i(){
            x.clearRect(0,0,w,h)
            q=[{x:0,y:h*.7+f},{x:0,y:h*.7-f}]
            while(q[1].x<w+f) d(q[0], q[1])
        }
        function d(i,j){   
            x.beginPath()
            x.moveTo(i.x, i.y)
            x.lineTo(j.x, j.y)
            var k = j.x + (z()*2-0.25)*f,
                n = y(j.y)
            x.lineTo(k, n)
            x.closePath()
            r-=u/-50
            x.fillStyle = '#'+(v(r)*127+128<<16 | v(r+u/3)*127+128<<8 | v(r+u/3*2)*127+128).toString(16)
            x.fill()
            q[0] = q[1]
            q[1] = {x:k,y:n}
        }
        function y(p){
            var t = p + (z()*2-1.1)*f
            return (t>h||t<0) ? y(p) : t
        }
        document.getElementById("intrologo").onclick = i
        document.getElementById("intrologo").ontouchstart = i
        i()
      
    </script>
    

    
      <div id="homelogo" class="homelogo"> 
    

        
          <div class="homelogoback" >
            <h1><a href="#content" id="logo">进无止境&#39;s 博客</a></h1>
            <h3></h3>
            <h5>Jim</h5>
            <!-- <p><a href="https://github.com/iTimeTraveler" target="_blank">Github</a></p> -->
          </div>
        
    
    </div>
  </div>

  <!-- 自适应主页背景大图 -->
  

 <!-- home_logo_image居中 -->
 
    <script>
        var homelogodiv = document.getElementById("homelogo");
        if (document.all.homelogo.offsetWidth > document.body.clientWidth) {
          homelogodiv.style.width = document.body.clientWidth + "px";
          homelogodiv.style.marginLeft = document.body.clientWidth * -0.5 + "px";
        } else {
          homelogodiv.style.width = homelogodiv.clientWidth  + "px";
          homelogodiv.style.marginLeft = (homelogodiv.clientWidth)  * -0.5 + "px";
        }
    </script>
  

  <div class="intro-navigate">
      <p class="navigater-list">
        
          <a id="beautifont" class="main-nav-link" href="/">首页</a>
        
          <a id="beautifont" class="main-nav-link" href="/archives">归档</a>
        
          <a id="beautifont" class="main-nav-link" href="/about">关于</a>
        
      </p>
  </div>

</header>
  
  <div id="container">
    <div id="wrap">
      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;">
  
    <article id="post-InputSystem001_LinuxInputDriver"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/12/InputSystem001_LinuxInputDriver/">Input系统——Linux驱动</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/12/InputSystem001_LinuxInputDriver/" class="article-date">
	  <time datetime="2017-04-12T04:22:33.000Z" itemprop="datePublished">2017-04-12</time>
	</a>

      
    <a class="article-category-link" href="/categories/Android/">Android</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/event/">event</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/input/">input</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/input系统/">input系统</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-InputSystem005_ExampleAPP"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/12/InputSystem005_ExampleAPP/">Input系统——APP事件监听及处理</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/12/InputSystem005_ExampleAPP/" class="article-date">
	  <time datetime="2017-04-12T04:22:33.000Z" itemprop="datePublished">2017-04-12</time>
	</a>

      
    <a class="article-category-link" href="/categories/Android/">Android</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>InputDevice<br><a href="https://developer.android.com/reference/android/view/InputDevice.html" target="_blank" rel="external">https://developer.android.com/reference/android/view/InputDevice.html</a></p>
<p>android.support.wearable 包</p>
<p><a href="http://stackoverflow.com/questions/24520240/import-android-support-wearable-cannot-be-resolved" target="_blank" rel="external">http://stackoverflow.com/questions/24520240/import-android-support-wearable-cannot-be-resolved</a></p>

      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/APP/">APP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/input/">input</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/input系统/">input系统</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-Android_init_rc"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/12/Android_init_rc/">Android init.rc</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/12/Android_init_rc/" class="article-date">
	  <time datetime="2017-04-12T04:22:33.000Z" itemprop="datePublished">2017-04-12</time>
	</a>

      
    <a class="article-category-link" href="/categories/Android/">Android</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="init-rc"><a href="#init-rc" class="headerlink" title="init.rc"></a>init.rc</h1>
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/init-rc/">init.rc</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-Android编译系统——完整编译过程分析"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/12/Android编译系统——完整编译过程分析/">Android编译系统——完整编译过程分析</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/12/Android编译系统——完整编译过程分析/" class="article-date">
	  <time datetime="2017-04-12T04:22:33.000Z" itemprop="datePublished">2017-04-12</time>
	</a>

      
    <a class="article-category-link" href="/categories/Android/">Android</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>###编译命令<br>    make //整体编译Android<br>    mm<br>    mmm<br>    get_build_var TARGET_PRODUCT  //获取指定变量的当前值</p>
<pre><code>待续...
</code></pre>
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编译/">编译</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-Android_mk"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/12/Android_mk/">Android.mk</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/12/Android_mk/" class="article-date">
	  <time datetime="2017-04-12T04:22:33.000Z" itemprop="datePublished">2017-04-12</time>
	</a>

      
    <a class="article-category-link" href="/categories/Android/">Android</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Android-mk"><a href="#Android-mk" class="headerlink" title="Android.mk"></a>Android.mk</h1>
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android-mk/">Android.mk</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Makefile/">Makefile</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/build/">build</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-InputSystem003_AndroidInputSystem"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/12/InputSystem003_AndroidInputSystem/">Input系统——Android Input系统</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/12/InputSystem003_AndroidInputSystem/" class="article-date">
	  <time datetime="2017-04-12T04:22:33.000Z" itemprop="datePublished">2017-04-12</time>
	</a>

      
    <a class="article-category-link" href="/categories/Android/">Android</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Input系统结构解析"><a href="#Input系统结构解析" class="headerlink" title="Input系统结构解析"></a>Input系统结构解析</h1><p>AndroidInput系统——JNI NativeInputManager InputManger InputReader<br><a href="https://docs.google.com/drawings/d/1DoS3SayZNpAqAMpjQ8h0O1eSb1nb9r9V7c47TjvqO2o/edit" target="_blank" rel="external">https://docs.google.com/drawings/d/1DoS3SayZNpAqAMpjQ8h0O1eSb1nb9r9V7c47TjvqO2o/edit</a><br><img src="https://docs.google.com/drawings/d/1DoS3SayZNpAqAMpjQ8h0O1eSb1nb9r9V7c47TjvqO2o/pub?w=998&amp;h=918" alt="AndroidInput系统——JNI NativeInputManager InputManger InputReader"></p>
<p>AndroidInput系统——InputReader<br><a href="https://docs.google.com/drawings/d/1A78eIrYTHg2nh-HrWJMpsMu64HitGj7dk_ciSajtex4/edit" target="_blank" rel="external">https://docs.google.com/drawings/d/1A78eIrYTHg2nh-HrWJMpsMu64HitGj7dk_ciSajtex4/edit</a><br><img src="https://docs.google.com/drawings/d/1A78eIrYTHg2nh-HrWJMpsMu64HitGj7dk_ciSajtex4/pub?w=982&amp;h=726" alt="AndroidInput系统——InputReader "></p>
<p>AndroidInput系统——InputDispatcher<br><a href="https://docs.google.com/drawings/d/19KStX_1m2rNCqjCouwW5DFWOY-e1ZbfDTcYAXrPSzOA/edit" target="_blank" rel="external">https://docs.google.com/drawings/d/19KStX_1m2rNCqjCouwW5DFWOY-e1ZbfDTcYAXrPSzOA/edit</a><br><img src="https://docs.google.com/drawings/d/19KStX_1m2rNCqjCouwW5DFWOY-e1ZbfDTcYAXrPSzOA/pub?w=960&amp;h=720" alt="AndroidInput系统——InputDispatcher "></p>
<p>AndroidInput系统——EventHub<br><a href="https://docs.google.com/drawings/d/1QAC0GFiARVOJcv6vugVNEiqIMkGZX0XXhiCuIDssvtk/edit" target="_blank" rel="external">https://docs.google.com/drawings/d/1QAC0GFiARVOJcv6vugVNEiqIMkGZX0XXhiCuIDssvtk/edit</a><br><img src="https://docs.google.com/drawings/d/1QAC0GFiARVOJcv6vugVNEiqIMkGZX0XXhiCuIDssvtk/pub?w=960&amp;h=720" alt="AndroidInput系统——EventHub"></p>
<h1 id="Android-Input系统相关结构体"><a href="#Android-Input系统相关结构体" class="headerlink" title="Android Input系统相关结构体"></a>Android Input系统相关结构体</h1><h3 id="1-input-device-id"><a href="#1-input-device-id" class="headerlink" title="1. input_device_id"></a>1. input_device_id</h3><pre><code>struct input_device_id {
 kernel_ulong_t flags;
 __u16 bustype;  // BUS_USB  BUS_BLUETOOTH  
 __u16 vendor;
 __u16 product;
 __u16 version;
 kernel_ulong_t evbit[INPUT_DEVICE_ID_EV_MAX / BITS_PER_LONG + 1];

 kernel_ulong_t keybit[INPUT_DEVICE_ID_KEY_MAX / BITS_PER_LONG + 1];
 kernel_ulong_t relbit[INPUT_DEVICE_ID_REL_MAX / BITS_PER_LONG + 1];
 kernel_ulong_t absbit[INPUT_DEVICE_ID_ABS_MAX / BITS_PER_LONG + 1];
 kernel_ulong_t mscbit[INPUT_DEVICE_ID_MSC_MAX / BITS_PER_LONG + 1];
 kernel_ulong_t ledbit[INPUT_DEVICE_ID_LED_MAX / BITS_PER_LONG + 1];
 kernel_ulong_t sndbit[INPUT_DEVICE_ID_SND_MAX / BITS_PER_LONG + 1];
 kernel_ulong_t ffbit[INPUT_DEVICE_ID_FF_MAX / BITS_PER_LONG + 1];
 kernel_ulong_t swbit[INPUT_DEVICE_ID_SW_MAX / BITS_PER_LONG + 1];
 kernel_ulong_t driver_info;
};
</code></pre><h3 id="2-input-event-input-h"><a href="#2-input-event-input-h" class="headerlink" title="2. input_event (input.h)"></a>2. input_event (input.h)</h3><pre><code>struct input_event {
    struct timeval time;
    __u16 type;
    __u16 code;
    __s32 value;
};
</code></pre><h3 id="3-RawEvent-EventHub-h"><a href="#3-RawEvent-EventHub-h" class="headerlink" title="3. RawEvent (EventHub.h)"></a>3. RawEvent (EventHub.h)</h3><pre><code>struct RawEvent {
    nsecs_t when;       time
    int32_t deviceId;   ID    = 1       ID         = 0
    int32_t type;       EV_REL= 0x02    EV_SYN     = 0x00
    int32_t code;       REL_X = 0x00    SYN_REPORT = 0
    int32_t value;      Value = 0x01    Value      = 0x00
};
</code></pre><h1 id="调试相关"><a href="#调试相关" class="headerlink" title="调试相关"></a>调试相关</h1><h3 id="查看event注册设备"><a href="#查看event注册设备" class="headerlink" title="查看event注册设备"></a>查看event注册设备</h3><pre><code>shell@rk3368_32:/dev/input # cat /proc/bus/input/devices
I: Bus=0000 Vendor=0000 Product=0003 Version=206a
N: Name=&quot;synaptics_dsx&quot;
P: Phys=synaptics_dsx/touch_input
S: Sysfs=/devices/ff140000.i2c/i2c-2/2-0020/input/input0
U: Uniq=
H: Handlers=event0 cpufreq ddr_freq 
B: PROP=2
B: EV=b
B: KEY=420 0 0 0 0 0 8000 0 0 0 0
B: ABS=2638000 3

I: Bus=0019 Vendor=0000 Product=0000 Version=0000
N: Name=&quot;rotary.35&quot;
P: Phys=
S: Sysfs=/devices/rotary.35/input/input1
U: Uniq=
H: Handlers=event1 
B: PROP=0
B: EV=5
B: REL=1

I: Bus=0019 Vendor=0001 Product=0001 Version=0100
N: Name=&quot;rk29-keypad&quot;
P: Phys=gpio-keys/input0
S: Sysfs=/devices/ff100000.adc/key.38/input/input2
U: Uniq=
H: Handlers=event2 ddr_freq keychord 
B: PROP=0
B: EV=3
B: KEY=8000 100000 0 0 0

I: Bus=0000 Vendor=0000 Product=0000 Version=0000
N: Name=&quot;temperature&quot;
P: Phys=
S: Sysfs=/devices/ff160000.i2c/i2c-4/4-005b/input/input3
U: Uniq=
H: Handlers=event3 
B: PROP=0
B: EV=9
B: ABS=40
</code></pre><h3 id="查看Handler个数"><a href="#查看Handler个数" class="headerlink" title="查看Handler个数"></a>查看Handler个数</h3><pre><code>shell@rk3368_box:/dev/input # ls -l                                            
crw-rw---- root     input     13,  64 2017-04-12 11:15 event0
crw-rw---- root     input     13,  65 2017-04-12 11:15 event1
crw-rw---- root     input     13,  66 2017-04-14 08:12 event2
crw-rw---- root     input     13,  67 2017-04-14 08:12 event3

cat event0 
cat event1
</code></pre><h3 id="获取事件"><a href="#获取事件" class="headerlink" title="获取事件"></a>获取事件</h3><pre><code># getevent -h
Usage: getevent [-t] [-n] [-s switchmask] [-S] [-v [mask]] [-d] [-p] [-i] [-l] [-q] [-c count] [-r] [device]
    -t: show time stamps
    -n: don&apos;t print newlines
    -s: print switch states for given bits
    -S: print all switch states
    -v: verbosity mask (errs=1, dev=2, name=4, info=8, vers=16, pos. events=32, props=64)
    -d: show HID descriptor, if available
    -p: show possible events (errs, dev, name, pos. events)
    -i: show all device info and possible events
    -l: label event types and names in plain text
    -q: quiet (clear verbosity mask)
    -c: print given number of events then exit
    -r: print rate events are received

常用命令组合：
    getevent -p    // see all of the keys and axes a device reports
    getevent -ip   // get more information, including HID mapping tables and debugging information
    getevent -lp   // option to display textual labels for all event codes
    getevent -lp
    getevent -r -q    监控设备的sendevent事件 


getevent -p             
add device 1: /dev/input/event3
  name:     &quot;temperature&quot;
add device 2: /dev/input/event1
  name:     &quot;rotary.35&quot;
add device 3: /dev/input/event0
  name:     &quot;synaptics_dsx&quot;
add device 4: /dev/input/event2
  name:     &quot;rk29-keypad&quot;

/dev/input/event1: 0002 0000 00000001   ID=1    EV_REL=0x02   REL_X = 0x00    Value = 0x01
/dev/input/event1: 0000 0000 00000000   ID=0    EV_SYN 0x00   SYN_REPORT = 0  Value = 0x00
/dev/input/event1: 0002 0000 00000001       
/dev/input/event1: 0000 0000 00000000       
/dev/input/event1: 0002 0000 00000001
/dev/input/event1: 0000 0000 00000000
/dev/input/event1: 0002 0000 ffffffff       EV_REL=0x02   REL_X = 0x00    Value = 0xffffffffff
/dev/input/event1: 0000 0000 00000000
/dev/input/event1: 0002 0000 ffffffff
</code></pre><h1 id="附-参考资料"><a href="#附-参考资料" class="headerlink" title="附(参考资料)"></a>附(参考资料)</h1><p><a href="https://source.android.com/devices/input/overview" target="_blank" rel="external">https://source.android.com/devices/input/overview</a><br><a href="https://www.kernel.org/doc/Documentation/input/event-codes.txt" target="_blank" rel="external">https://www.kernel.org/doc/Documentation/input/event-codes.txt</a><br><a href="https://www.kernel.org/doc/Documentation/input/input.txt" target="_blank" rel="external">https://www.kernel.org/doc/Documentation/input/input.txt</a></p>

      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/event/">event</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/input/">input</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/input系统/">input系统</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-RK平台分区信息"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/11/RK平台分区信息/">RK平台分区信息</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/11/RK平台分区信息/" class="article-date">
	  <time datetime="2017-04-11T09:35:57.000Z" itemprop="datePublished">2017-04-11</time>
	</a>

      
    <a class="article-category-link" href="/categories/RK/">RK</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="RK平台分区信息与eMMC-partitions对应"><a href="#RK平台分区信息与eMMC-partitions对应" class="headerlink" title="RK平台分区信息与eMMC partitions对应"></a>RK平台分区信息与eMMC partitions对应</h2><pre><code>lrwxrwxrwx root     root    2013-01-21 08:50 uboot            -&gt; /dev/block/mmcblk0p1
lrwxrwxrwx root     root    2013-01-21 08:50 trust            -&gt; /dev/block/mmcblk0p2
lrwxrwxrwx root     root    2013-01-21 08:50 misc             -&gt; /dev/block/mmcblk0p3
lrwxrwxrwx root     root    2013-01-21 08:50 resource         -&gt; /dev/block/mmcblk0p4
lrwxrwxrwx root     root    2013-01-21 08:50 kernel           -&gt; /dev/block/mmcblk0p5
lrwxrwxrwx root     root    2013-01-21 08:50 boot             -&gt; /dev/block/mmcblk0p6
lrwxrwxrwx root     root    2013-01-21 08:50 recovery         -&gt; /dev/block/mmcblk0p7
lrwxrwxrwx root     root    2013-01-21 08:50 backup           -&gt; /dev/block/mmcblk0p8
lrwxrwxrwx root     root    2013-01-21 08:50 cache            -&gt; /dev/block/mmcblk0p9
lrwxrwxrwx root     root    2013-01-21 08:50 kpanic           -&gt; /dev/block/mmcblk0p10
lrwxrwxrwx root     root    2013-01-21 08:50 system           -&gt; /dev/block/mmcblk0p11
lrwxrwxrwx root     root    2013-01-21 08:50 metadata         -&gt; /dev/block/mmcblk0p12
lrwxrwxrwx root     root    2013-01-21 08:50 baseparamer      -&gt; /dev/block/mmcblk0p13
lrwxrwxrwx root     root    2013-01-21 08:50 userdata         -&gt; /dev/block/mmcblk0p14
lrwxrwxrwx root     root    2013-01-21 08:50 radical_update   -&gt; /dev/block/mmcblk0p15
lrwxrwxrwx root     root    2013-01-21 08:50 user             -&gt; /dev/block/mmcblk0p16

mmcblk0: p1 p2 p3 p4 p5 p6 p7 p8 p9 p10 p11 p12 p13 p14 p15 p16 p17

/mnt/external_sd vfat                                            /dev/block/mmcblk1p1
</code></pre><h2 id="RK平台各分区介绍"><a href="#RK平台各分区介绍" class="headerlink" title="RK平台各分区介绍"></a>RK平台各分区介绍</h2><pre><code>uboot.img
trust.img
misc.img      RK平台，misc分区内容用于启动模式切换，是升级基带还是进入Recovery（misc分区的内容可以被按键出发改变???）
resource.img  RK平台资源映像，内含开机图片和内核的设备树信息。
kernel
boot.img      Android 的初始文件映像，负责初始化并加载 system 分区，一般Android系统这个镜像中包含ramdisk.img根文件系统+kernel（RK平台的boot.img是没包含kernel部分的）
    ramdisk.img   是根文件系统，是root目录打包成的镜像（ramdisk-recovery.img）
recovery.img  恢复模式系统启动镜像。内容和boot.img雷同（RK平台recovery.img包含kernel部分），但是其中的ramdisk.img（ramdisk-recovery.img）有些许不同：
              recovery.fstab文件、sbin下部分工具、build.prop、init.bootmode.emmc.rc、sepolicy等
backup
cache
kpanic

system.img    包括了主要的包、库等文件
metadata
baseparameter
userdata.img  包括了一些用户数据
radical_update
user
</code></pre><h2 id="另："><a href="#另：" class="headerlink" title="另："></a>另：</h2><pre><code>RK平台生成boot.img recovery.img system.img userdata.img是使用自己的mkimage.sh工具讲root system data 目录生成的
再使用工具mkupdate.sh生成update.img的（不带userdata.img）
烧写userdata.img 需要使用./upgrade_tool DI userdata userdata.img 单独烧写
</code></pre>
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RK/">RK</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分区/">分区</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-Android编译系统——system.img userdata.img recovery.img目标编译过程"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/11/Android编译系统——system.img userdata.img recovery.img目标编译过程/">Android编译系统——ramdisk.img system.img userdata.img recovery.img目标编译过程</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/11/Android编译系统——system.img userdata.img recovery.img目标编译过程/" class="article-date">
	  <time datetime="2017-04-11T09:35:57.000Z" itemprop="datePublished">2017-04-11</time>
	</a>

      
    <a class="article-category-link" href="/categories/Android/">Android</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="image-介绍"><a href="#image-介绍" class="headerlink" title="image 介绍"></a>image 介绍</h2><pre><code>boot.img      Android 的初始文件映像，负责初始化并加载 system 分区，一般Android系统这个镜像中包含ramdisk.img根文件系统+kernel（RK平台的boot.img是没包含kernel部分的）
recovery.img  恢复模式系统启动镜像。内容和boot.img雷同（RK平台recovery.img包含kernel部分），但是其中的ramdisk.img（ramdisk-recovery.img）有些许不同：
              recovery.fstab文件、sbin下部分工具、build.prop、init.bootmode.emmc.rc、sepolicy等

ramdisk.img   是根文件系统，是root目录打包成的镜像（ramdisk-recovery.img）
system.img    包括了主要的包、库等文件
userdata.img  包括了一些用户数据
</code></pre><h2 id="image-目标编译过程"><a href="#image-目标编译过程" class="headerlink" title="image 目标编译过程"></a>image 目标编译过程</h2><pre><code>---build/core/main.mk中---
默认目标，即目标all
.PHONY: droid
DEFAULT_GOAL := droid
$(DEFAULT_GOAL):             //root目标droid

droid: droidcore dist_files  //1级目标，droidcore

droidcore: files \             //2级目标，files systemimage ...
    systemimage \
    $(INSTALLED_BOOTIMAGE_TARGET) \
    $(INSTALLED_RECOVERYIMAGE_TARGET) \
    $(INSTALLED_USERDATAIMAGE_TARGET) \
    $(INSTALLED_CACHEIMAGE_TARGET) \
    $(INSTALLED_VENDORIMAGE_TARGET) \
    $(INSTALLED_FILES_FILE)

---build/core/Makefile中---
INSTALLED_SYSTEMIMAGE := $(PRODUCT_OUT)/system.img
BUILT_SYSTEMIMAGE := $(systemimage_intermediates)/system.img
FULL_SYSTEMIMAGE_DEPS := $(INTERNAL_SYSTEMIMAGE_FILES) $(INTERNAL_USERIMAGES_DEPS)
INSTALLED_FILES_FILE := $(PRODUCT_OUT)/installed-files.txt


systemimage: $(INSTALLED_SYSTEMIMAGE)        //3级目标 ./system.img

$(INSTALLED_SYSTEMIMAGE): $(BUILT_SYSTEMIMAGE) $(RECOVERY_FROM_BOOT_PATCH) | $(ACP)    //4级目标  _./system.img

$(BUILT_SYSTEMIMAGE): $(FULL_SYSTEMIMAGE_DEPS) $(INSTALLED_FILES_FILE)                 //5级目标  
    $(call build-systemimage-target,$@)


BUILT_USERDATAIMAGE_TARGET := $(PRODUCT_OUT)/userdata.img
INSTALLED_USERDATAIMAGE_TARGET := $(BUILT_USERDATAIMAGE_TARGET)
INTERNAL_USERDATAIMAGE_FILES := \                                                      //4级目标
    $(filter $(TARGET_OUT_DATA)/%,$(ALL_DEFAULT_INSTALLED_MODULES))

$(INSTALLED_USERDATAIMAGE_TARGET): $(INTERNAL_USERIMAGES_DEPS) \                       //3级目标
                               $(INTERNAL_USERDATAIMAGE_FILES)
    $(build-userdataimage-target)

define build-userdataimage-target  //做userdata.img分区build操作
  $(call pretty,&quot;Target userdata fs image: $(INSTALLED_USERDATAIMAGE_TARGET)&quot;)
  @mkdir -p $(TARGET_OUT_DATA)
  @mkdir -p $(userdataimage_intermediates) &amp;&amp; rm -rf $(userdataimage_intermediates)/userdata_image_info.txt
  $(call generate-userimage-prop-dictionary, $(userdataimage_intermediates)/userdata_image_info.txt, skip_fsck=true)
  $(hide) PATH=$(foreach p,$(INTERNAL_USERIMAGES_BINARY_PATHS),$(p):)$$PATH \
      ./build/tools/releasetools/build_image.py \
      $(TARGET_OUT_DATA) $(userdataimage_intermediates)/userdata_image_info.txt $(INSTALLED_USERDATAIMAGE_TARGET)
  $(hide) $(call assert-max-image-size,$(INSTALLED_USERDATAIMAGE_TARGET),$(BOARD_USERDATAIMAGE_PARTITION_SIZE))
endef


注 system.img userdata.img 会依赖skip_userdata.img := 这个变量 及 嵌套依赖device/.../BoardConfig.mk中的TARGET_USERIMAGES_USE_EXT4、BOARD_SYSTEMIMAGE_PARTITION_SIZE、BOARD_USERDATAIMAGE_PARTITION_SIZE和
</code></pre><h2 id="image解压方法"><a href="#image解压方法" class="headerlink" title="image解压方法"></a>image解压方法</h2><pre><code>ramdisk.img   用file命令查看显示ramdisk.img: gzip compressed data, from Unix，采用cpio打包，gzip压缩的
    cp -a ramdisk.img 000/ramdisk.img.gz
    cd 000/
    gunzip ramdisk.img.gz //得到ramdisk.img 文件，但是和原始的ramdisk.img是不一样的，大小要大不少
    mkdir root
    cd root
    cpio –i -F ../ramdisk.img

system.img    用file命令查看显示system.img: data
    cp -a system.img 000/system.img
    cd 000/
    out/host/linux-x86/bin/simg2img system.img system.ext4.img //用simg2img工具把system.img转为为ext4文件格式
    mkdir system                                       //建立system目录
    sudo mount -t ext4 -o loop system.ext4.img system  //将ext4格式的镜像挂在到system目录

userdata.img  用file命令查看显示userdata.img: data
    同system.img

recovery.img  用file命令查看显示recovery.img: data
    需要使用外部工具https://github.com/xiaolu/mkbootimg_tools.git  mkboot命令
    ./mkbootimg_tools/mkboot recovery.img recovery

boot.img      用file命令查看显示boot.img: data
    需要使用外部工具https://github.com/xiaolu/mkbootimg_tools.git  mkboot命令
    ./mkbootimg_tools/mkboot boot.img boot 
</code></pre><h2 id="image压缩方法"><a href="#image压缩方法" class="headerlink" title="image压缩方法"></a>image压缩方法</h2><pre><code>a. ramdisk 使用cpio -o -H | gzip 生成ramdisk.img
b. system userdata recovery都可以使用mkuserimg.sh来压缩成镜像
   mkuserimg.sh -s 镜像源目录 镜像输出文件 ext4 挂在点 分区size FILE_CONTEXTS文件
</code></pre><h2 id="单独编译image"><a href="#单独编译image" class="headerlink" title="单独编译image"></a>单独编译image</h2><pre><code>make systemimage - system.img
make userdataimage - userdata.img
make ramdisk - ramdisk.img
make snod - 快速打包system.img (with this command, it will build a new system.img very quickly. 
            well, you cannot use &quot;make snod&quot; for all the situations. it would not check the dependences. 
            if you change some code in the framework which will effect other applications)
</code></pre><h2 id="附"><a href="#附" class="headerlink" title="附:"></a>附:</h2><pre><code>simg2img解压缩工具: Convert Android sparse images to raw images. 在out/host/linux-x86/bin/simg2img可以找到
用法：simg2img &lt;sparse_image_files&gt; &lt;raw_image_file&gt;

mkuserimg.sh镜像制作工具，在out/host/linux-x86/bin/mkuserimg.sh可以找到，工具中会调用make_ext4fs
用法：mkuserimg.sh [-s] SRC_DIR OUTPUT_FILE EXT_VARIANT MOUNT_POINT SIZE [-j &lt;journal_size&gt;]
         [-T TIMESTAMP] [-C FS_CONFIG] [-B BLOCK_LIST_FILE] [FILE_CONTEXTS]

    例如制作system.img和userdata.img时：
    Running:  mkuserimg.sh -s out/target/product/rk3368_box/system out/target/product/rk3368_box/obj/PACKAGING/systemimage_intermediates/system.img ext4 system 1073741824 out/target/product/rk3368_box/root/file_contexts
    make_ext4fs -s -T -1 -S out/target/product/rk3368_box/root/file_contexts -l 1073741824 -a system out/target/product/rk3368_box/obj/PACKAGING/systemimage_intermediates/system.img out/target/product/rk3368_box/system

    Running:  mkuserimg.sh -s out/target/product/rk3368_box/data out/target/product/rk3368_box/userdata.img ext4 data 2147483648 out/target/product/rk3368_box/root/file_contexts
    make_ext4fs -s -T -1 -S out/target/product/rk3368_box/root/file_contexts -l 2147483648 -a data out/target/product/rk3368_box/userdata.img out/target/product/rk3368_box/data

make_ext4fs工具：用于Android平台上制作ext4文件系统的镜像，在out/host/linux-x86/bin/make_ext4fs
用法：make_ext4fs [ -l &lt;len&gt; ] [ -j &lt;journal size&gt; ] [ -b &lt;block_size&gt; ]
                 [ -g &lt;blocks per group&gt; ] [ -i &lt;inodes&gt; ] [ -I &lt;inode size&gt; ]
                 [ -L &lt;label&gt; ] [ -f ] [ -a &lt;android mountpoint&gt; ]
                 [ -S file_contexts ] [ -C fs_config ] [ -T timestamp ]
                 [ -z | -s ] [ -w ] [ -c ] [ -J ] [ -v ] [ -B &lt;block_list_file&gt; ] &lt;filename&gt; [&lt;directory&gt;]
        -l 分区大小 支持512M 以及1073741824 单位为bytes
        -s 生成ext4的S模式制作
        -T timestamp  // -1 mean what? fix me
        -a 挂在点
        -S  file_contexts文件
        &lt;filename&gt;  生成的目的文件
        &lt;directory&gt; 源文件目录
</code></pre><h2 id="附2——一般Android系统的boot-img格式-RK平台的boot-img是没包含kernel部分的"><a href="#附2——一般Android系统的boot-img格式-RK平台的boot-img是没包含kernel部分的" class="headerlink" title="附2——一般Android系统的boot.img格式(RK平台的boot.img是没包含kernel部分的)"></a>附2——一般Android系统的boot.img格式(RK平台的boot.img是没包含kernel部分的)</h2><pre><code>因为boot.img的格式比较简单，它主要分为三大块（有的可能有四块）

+—————–+
| boot header | 1 page
+—————–+
| kernel | n pages
+—————–+
| ramdisk | m pages
+—————–+
| second stage | o pages
+—————–+
n = (kernel_size + page_size – 1) / page_size
m = (ramdisk_size + page_size – 1) / page_size
o = (second_size + page_size – 1) / page_size

a. all entities are page_size aligned in flash
b. kernel and ramdisk are required (size != 0)
c. second is optional (second_size == 0 -&gt; no second)
</code></pre>
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/image/">image</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/编译/">编译</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-RK平台Android分区大小修改说明"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/11/RK平台Android分区大小修改说明/">RK平台Android分区大小修改说明</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/11/RK平台Android分区大小修改说明/" class="article-date">
	  <time datetime="2017-04-11T01:01:57.000Z" itemprop="datePublished">2017-04-11</time>
	</a>

      
    <a class="article-category-link" href="/categories/Android/">Android</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>不同于一般的Android系统（一般Android系统分区信息在BoardConfig.mk BoardConfigCommon.mk中），RK平台的分区信息文件在自带的烧录工具包中的parameter文件中</p>
<h6 id="如下是板子的parameter文件"><a href="#如下是板子的parameter文件" class="headerlink" title="如下是板子的parameter文件:"></a>如下是板子的parameter文件:</h6><pre><code>FIRMWARE_VER: 5.1.0
MACHINE_MODEL: Geekbox
MACHINE_ID: 007
MANUFACTURER: RK3368
MAGIC: 0x5041524B
ATAG: 0x00200800
MACHINE: 3368
CHECK_MASK: 0x80
PWR_HLD: 0,0,A,0,1
#KERNEL_IMG: 0x00280000
#FDT_NAME: rk-kernel.dtb
#RECOVER_KEY: 1,1,0,20,0
#in section; per section 512(0x200) bytes
CMDLINE: console=ttyS2 androidboot.baseband=N/A androidboot.selinux=permissive androidboot.hardware=rk30board androidboot.console=ttyS2 init=/init mtdparts=rk29xxnand:0x00002000@0x00002000(uboot),0x00002000@0x00004000(trust),0x00002000@0x00006000(misc),0x00008000@0x00008000(resource),0x00008000@0x00010000(kernel),0x00010000@0x00018000(boot),0x00010000@0x00028000(recovery),0x00038000@0x00038000(backup),0x00040000@0x00070000(cache),0x00002000@0x000B0000(kpanic),0x00200000@0x000B2000(system),0x00008000@0x002B2000(metadata),0x00002000@0x002BA000(baseparamer),0x00400000@0x002BC000(userdata),0x00020000@0x006BC000(radical_update),-@0x006DC000(user)
</code></pre><p>分区信息在mtdparts=rk29xxnand:字段后面部分，所以我们修改这部分内容就可以了</p>
<h6 id="这部分信息格式介绍-如："><a href="#这部分信息格式介绍-如：" class="headerlink" title="这部分信息格式介绍 如："></a>这部分信息格式介绍 如：</h6><pre><code>0x00002000@0x00002000(uboot)  分区大小计算为=0x00002000*512Bytes = 4MBytes
↑分区的sector数，每个sector=512Bytes
           ↑分区起始地址
                      ↑分区名

0x00200000@0x002BC000(userdata)  分区大小0x00200000*512Bytes = 1073741824 Bytes

注: sector 512Bytes 逻辑单位???
    page: FLASH操作的基本单位。  最小读/写单元 page， 1page = 4096Bytes = 4KB；
    block:最小擦除单元 block，1block = (32 * page) = (32 * 4KB) = 131072Bytes = 128KB；     
</code></pre><p>上述mtdparts=rk29xxnand:字段中所有分区都是连续的，当前分区起始地址+当前分区size和下个分区起始地址都是连续的，所以当修改了其中某个分区后，在它后面的分区的地址都要顺序往前或往后。</p>
<h6 id="以下是我将userdata分区缩小为1GB，将user分区扩大1GB的例子："><a href="#以下是我将userdata分区缩小为1GB，将user分区扩大1GB的例子：" class="headerlink" title="以下是我将userdata分区缩小为1GB，将user分区扩大1GB的例子："></a>以下是我将userdata分区缩小为1GB，将user分区扩大1GB的例子：</h6><pre><code>修改前:                            size             offset
0x00002000@0x00000000(parameter)//4MB               4MB
0x00002000@0x00002000(uboot),   //4MB               8MB
0x00002000@0x00004000(trust),   //4MB               12MB
0x00002000@0x00006000(misc),    //4MB               16MB
0x00008000@0x00008000(resource),//16MB              32MB
0x00008000@0x00010000(kernel),  //16MB              48
0x00010000@0x00018000(boot),    //32MB              80
0x00010000@0x00028000(recovery),//32MB              112
0x00038000@0x00038000(backup),  //112MB             224
0x00040000@0x00070000(cache),   //128MB             352
0x00002000@0x000B0000(kpanic),  //4MB               356
0x00200000@0x000B2000(system),  //1024MB            1380
0x00008000@0x002B2000(metadata),//16MB              1396
0x00002000@0x002BA000(baseparamer), //4MB           1400MB
0x00400000@0x002BC000(userdata),    //2048MB        3448
0x00020000@0x006BC000(radical_update), //64MB       3512
         -@0x006DC000(user)            //212MB/11394MB  ...        

修改后:
0x00002000@0x00002000(uboot),   //4MB               8MB
0x00002000@0x00004000(trust),   //4MB               12MB
0x00002000@0x00006000(misc),    //4MB               16MB
0x00008000@0x00008000(resource),//16MB              32MB
0x00008000@0x00010000(kernel),  //16MB              48
0x00010000@0x00018000(boot),    //32MB              80
0x00010000@0x00028000(recovery),//32MB              112
0x00038000@0x00038000(backup),  //112MB             224
0x00040000@0x00070000(cache),   //128MB             352
0x00002000@0x000B0000(kpanic),  //4MB               356
0x00200000@0x000B2000(system),  //1024MB            1380
0x00008000@0x002B2000(metadata),//16MB              1396
0x00002000@0x002BA000(baseparamer), //4MB           1400MB
0x00200000@0x002BC000(userdata),    //1024MB        2424MB
0x00020000@0x004BC000(radical_update), //64MB       2488MB
         -@0x004DC000(user)            //1024+212MB = 1236MB   
</code></pre><h5 id="注："><a href="#注：" class="headerlink" title="注："></a>注：</h5><pre><code>1.分区的大小要以4MB对齐！  
2.分区总大小不能超过flash的总长度
</code></pre><h5 id="修改parameter后效果："><a href="#修改parameter后效果：" class="headerlink" title="修改parameter后效果："></a>修改parameter后效果：</h5><pre><code>shell@rk3368_32:/ # df
Filesystem               Size     Used     Free   Blksize
/dev                   495.2M    36.0K   495.2M   4096
/sys/fs/cgroup         495.2M    12.0K   495.2M   4096
/mnt/asec              495.2M     0.0K   495.2M   4096
/mnt/obb               495.2M     0.0K   495.2M   4096
/system               1004.2M   403.0M   601.2M   4096
/cache                 122.0M   140.0K   121.8M   4096
/metadata               11.7M    40.0K    11.7M   4096
/data                  991.9M    87.5M   904.4M   4096
/mnt/shell/emulated    991.9M    87.5M   904.4M   4096
/mnt/internal_sd         1.2G   136.0K     1.2G   8192
/mnt/secure/asec         1.2G   136.0K     1.2G   8192
</code></pre><h3 id="一般Android平台分区修改"><a href="#一般Android平台分区修改" class="headerlink" title="一般Android平台分区修改"></a>一般Android平台分区修改</h3><pre><code>eMMC 分区信息
# cat /proc/partitions                                       
major      minor  #blocks  name
 254        0     520912   zram0
 179        0   15267840   mmcblk0
 179        1       4096   mmcblk0p1
 179        2       4096   mmcblk0p2
 179        3       4096   mmcblk0p3
 179        4      16384   mmcblk0p4
 179        5      16384   mmcblk0p5
 179        6      32768   mmcblk0p6
 179        7      32768   mmcblk0p7
 179        8     114688   mmcblk0p8
 179        9     131072   mmcblk0p9
 179       10       4096   mmcblk0p10
 179       11    1048576   mmcblk0p11
 179       12      16384   mmcblk0p12
 179       13       4096   mmcblk0p13
 179       14    2097152   mmcblk0p14
 179       15      65536   mmcblk0p15
 179       16   11667456   mmcblk0p16
mmcblk0即emmc的容量（单位kb）

#ls /dev/block/platform/ff0f0000.rksdmmc/by-name/* -l 
lrwxrwxrwx root     root    2013-01-21 08:50 uboot            -&gt; /dev/block/mmcblk0p1
lrwxrwxrwx root     root    2013-01-21 08:50 trust            -&gt; /dev/block/mmcblk0p2
lrwxrwxrwx root     root    2013-01-21 08:50 misc             -&gt; /dev/block/mmcblk0p3
lrwxrwxrwx root     root    2013-01-21 08:50 resource         -&gt; /dev/block/mmcblk0p4
lrwxrwxrwx root     root    2013-01-21 08:50 kernel           -&gt; /dev/block/mmcblk0p5
lrwxrwxrwx root     root    2013-01-21 08:50 boot             -&gt; /dev/block/mmcblk0p6
lrwxrwxrwx root     root    2013-01-21 08:50 recovery         -&gt; /dev/block/mmcblk0p7
lrwxrwxrwx root     root    2013-01-21 08:50 backup           -&gt; /dev/block/mmcblk0p8
lrwxrwxrwx root     root    2013-01-21 08:50 cache            -&gt; /dev/block/mmcblk0p9
lrwxrwxrwx root     root    2013-01-21 08:50 kpanic           -&gt; /dev/block/mmcblk0p10
lrwxrwxrwx root     root    2013-01-21 08:50 system           -&gt; /dev/block/mmcblk0p11
lrwxrwxrwx root     root    2013-01-21 08:50 metadata         -&gt; /dev/block/mmcblk0p12
lrwxrwxrwx root     root    2013-01-21 08:50 baseparamer      -&gt; /dev/block/mmcblk0p13
lrwxrwxrwx root     root    2013-01-21 08:50 userdata         -&gt; /dev/block/mmcblk0p14
lrwxrwxrwx root     root    2013-01-21 08:50 radical_update   -&gt; /dev/block/mmcblk0p15
lrwxrwxrwx root     root    2013-01-21 08:50 user             -&gt; /dev/block/mmcblk0p16


即userdata 分区 大小为2097152*1024KB = 2147483648B

BoardConfig.mk 中修改指定变量即可：
BOARD_BOOTIMAGE_PARTITION_SIZE := 16777216
BOARD_RECOVERYIMAGE_PARTITION_SIZE := 16793600
BOARD_SYSTEMIMAGE_PARTITION_SIZE := 2147483648
BOARD_OEMIMAGE_PARTITION_SIZE := 67108864
BOARD_USERDATAIMAGE_PARTITION_SIZE := 25253773312 ---&gt; 2147483648B
BOARD_CACHEIMAGE_PARTITION_SIZE := 268435456
BOARD_CACHEIMAGE_FILE_SYSTEM_TYPE := ext4
BOARD_FLASH_BLOCK_SIZE := 131072
</code></pre>
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RK/">RK</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分区/">分区</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-Hexo入手"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/2017/04/07/Hexo入手/">Hexo入手</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2017/04/07/Hexo入手/" class="article-date">
	  <time datetime="2017-04-07T10:01:57.000Z" itemprop="datePublished">2017-04-07</time>
	</a>

      
    <a class="article-category-link" href="/categories/Hexo/">Hexo</a>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h4 id="1-安装nodejs"><a href="#1-安装nodejs" class="headerlink" title="1. 安装nodejs"></a>1. 安装nodejs</h4><pre><code>从官网下载对应平台binary 包，安装（linux直接将bin lib目录的文件cp到usr/local对应目录下，Window直接点击安装）
</code></pre><h4 id="2-安装hexo"><a href="#2-安装hexo" class="headerlink" title="2. 安装hexo"></a>2. 安装hexo</h4><pre><code>npm install hexo-cli -g
</code></pre><h4 id="3-新建blog"><a href="#3-新建blog" class="headerlink" title="3. 新建blog"></a>3. 新建blog</h4><pre><code>hexo init blog
cd blog
npm install
hexo server
</code></pre><h4 id="3-解决一个warning"><a href="#3-解决一个warning" class="headerlink" title="3. 解决一个warning"></a>3. 解决一个warning</h4><pre><code>npm install -g npm@3.3.12
npm install hexo-deployer-git --save
</code></pre><h4 id="4-配置-config-yml"><a href="#4-配置-config-yml" class="headerlink" title="4. 配置_config.yml"></a>4. 配置_config.yml</h4><pre><code>language: zh-CN
deploy:
  type: git
  repo: &lt;repository url&gt;
  branch: [branch]
  message: [message]
</code></pre><h4 id="5-部署"><a href="#5-部署" class="headerlink" title="5. 部署"></a>5. 部署</h4><pre><code>hexo deploy -generate   //hexo d -g 
</code></pre>
      
    </div>
    <footer class="article-footer">
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/网页博客/">网页博客</a></li></ul>

    </footer>
  </div>
  
</article>

<!-- Table of Contents -->

  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">下一页 &raquo;</a>
  </nav>

</section>
        
      </div>
      
        <div align="center" style="margin-top: 30px;"><hr class="hr" style="margin:0px; height:3px;"></div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2012 - 2017 进无止境&#39;s 博客 All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				<span id="busuanzi_container_site_uv"> 访客数 : <span id="busuanzi_value_site_uv"></span></span> |  
				<span id="busuanzi_container_site_pv"> 访问量 : <span id="busuanzi_value_site_pv"></span></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    


  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>


  <script src="/js/home.js"></script>








  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">设置</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              正文字号大小
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            您已调整页面字体大小
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              夜间护眼模式
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            夜间模式已经开启，再次单击按钮即可关闭 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关 于&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            进无止境&#39;s 博客
          </div>
          <div class="panel-body">
            Copyright © 2017 Jim All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
    </div>
  </div>
</div>
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  

	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>


</body>
</html>